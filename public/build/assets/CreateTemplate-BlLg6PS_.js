import{r as p,j as e,Q as L,t as C,S as z}from"./app-BCw1tvXf.js";import{B}from"./badge-BqVATA5I.js";import{B as n}from"./button-CUOcSF3l.js";import{C as N,b as _,c as T,d as y,a as S}from"./card-B5j4ta9c.js";import{I as f}from"./input-DTRL0anS.js";import{L as m}from"./label-CMVlQqZg.js";import{S as O,a as W,b as Q,c as H,d as J}from"./select-B67tNqw4.js";import{T as k}from"./textarea-CUTayS-w.js";import{A as K,S as M}from"./app-layout-acI46LDg.js";import{A as U}from"./arrow-left-CUXhjCW7.js";import{P as w}from"./plus-qF-BC0Hy.js";import{G as X}from"./grip-vertical-B2J15rDM.js";import{T as q}from"./trash-2-tcezDjdq.js";import{S as Y}from"./save-CxT7A-mr.js";/* empty css            */import"./index-DzBhJDo2.js";import"./index-HkQZ_pMn.js";import"./index-QPOaYY_B.js";import"./chevron-up-BiSlpR5N.js";import"./app-logo-icon-CvOjhXRH.js";const Z=[{title:"Dashboard",href:"/dashboard"},{title:"Workflows",href:"/tasks"},{title:"Novo Template",href:"/tasks/templates/create"}];function be({benefitTypes:P}){const[a,D]=p.useState({benefit_type:"",name:"",description:""}),[o,c]=p.useState([{title:"",description:"",order:1,required_documents:[]}]),[x,j]=p.useState(!1),[d,u]=p.useState({}),h=(s,t)=>{D(r=>({...r,[s]:t})),d[s]&&u(r=>({...r,[s]:""}))},E=s=>{s.preventDefault();const t={};a.benefit_type||(t.benefit_type="Selecione um tipo de benefício"),a.name.trim()||(t.name="Nome do template é obrigatório");const r=o.filter(i=>i.title.trim()&&i.description.trim());if(r.length===0&&(t.tasks="Adicione pelo menos uma tarefa válida"),Object.keys(t).length>0){u(t);return}j(!0),z.post("/tasks/templates",{benefit_type:a.benefit_type,name:a.name,description:a.description,tasks:JSON.stringify(r)},{onFinish:()=>j(!1),onError:i=>u(i)})},I=()=>{c([...o,{title:"",description:"",order:o.length+1,required_documents:[]}])},F=s=>{const r=o.filter((i,l)=>l!==s).map((i,l)=>({...i,order:l+1}));c(r)},v=(s,t,r)=>{const i=[...o];i[s]={...i[s],[t]:r},c(i)},b=(s,t)=>{if(t.trim()){const r=[...o];r[s].required_documents=[...r[s].required_documents,t.trim()],c(r)}},A=(s,t)=>{const r=[...o];r[s].required_documents=r[s].required_documents.filter((i,l)=>l!==t),c(r)},g=(s,t)=>{const r=[...o],i=t==="up"?s-1:s+1;i>=0&&i<r.length&&([r[s],r[i]]=[r[i],r[s]],r.forEach((l,V)=>{l.order=V+1}),c(r))},R=s=>({aposentadoria_por_idade:[{title:"Coletar documentos pessoais",description:"RG, CPF, certidão de nascimento, comprovante de residência",order:1,required_documents:["RG","CPF","Certidão de nascimento","Comprovante de residência"]},{title:"Solicitar CNIS",description:"Obter extrato do CNIS atualizado no site do INSS",order:2,required_documents:["CNIS"]},{title:"Verificar idade do segurado",description:"Confirmar se atende aos requisitos de idade (65 anos homem, 60 anos mulher)",order:3,required_documents:[]},{title:"Calcular tempo de contribuição",description:"Verificar se possui pelo menos 15 anos de contribuição",order:4,required_documents:[]},{title:"Preparar petição inicial",description:"Elaborar petição de aposentadoria por idade",order:5,required_documents:[]}],aposentadoria_por_tempo_contribuicao:[{title:"Coletar documentos pessoais",description:"RG, CPF, certidão de nascimento, comprovante de residência",order:1,required_documents:["RG","CPF","Certidão de nascimento","Comprovante de residência"]},{title:"Solicitar CNIS completo",description:"Obter CNIS com histórico completo de contribuições",order:2,required_documents:["CNIS"]},{title:"Calcular tempo de contribuição",description:"Verificar se possui 35 anos (homem) ou 30 anos (mulher) de contribuição",order:3,required_documents:[]},{title:"Analisar períodos especiais",description:"Verificar atividades especiais, insalubres ou perigosas",order:4,required_documents:["PPP","LTCAT","Laudos técnicos"]},{title:"Preparar petição inicial",description:"Elaborar petição de aposentadoria por tempo de contribuição",order:5,required_documents:[]}],auxilio_doenca:[{title:"Coletar documentos pessoais",description:"RG, CPF, comprovante de residência",order:1,required_documents:["RG","CPF","Comprovante de residência"]},{title:"Reunir documentos médicos",description:"Coletar laudos, exames e relatórios médicos",order:2,required_documents:["Laudos médicos","Exames","Relatórios médicos"]},{title:"Verificar carência",description:"Confirmar 12 meses de contribuição",order:3,required_documents:["CNIS"]},{title:"Agendar perícia médica",description:"Solicitar agendamento de perícia no INSS",order:4,required_documents:[]}]})[s]||[],G=()=>{if(a.benefit_type){const s=R(a.benefit_type);s.length>0&&c(s)}};return e.jsxs(K,{breadcrumbs:Z,children:[e.jsx(L,{title:"Novo Template de Workflow - PrevidIA"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"flex items-center text-3xl font-bold",children:[e.jsx(M,{className:"mr-3 h-8 w-8 text-primary"}),"Novo Template de Workflow"]}),e.jsx("p",{className:"text-muted-foreground",children:"Crie um template de tarefas para um tipo específico de benefício"})]}),e.jsx(C,{href:"/tasks?tab=templates",children:e.jsxs(n,{variant:"outline",children:[e.jsx(U,{className:"mr-2 h-4 w-4"}),"Voltar"]})})]}),e.jsxs("form",{onSubmit:E,className:"space-y-6",children:[e.jsxs(N,{children:[e.jsxs(_,{children:[e.jsx(T,{children:"Informações do Template"}),e.jsx(y,{children:"Configure as informações básicas do template"})]}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"benefit_type",children:"Tipo de Benefício *"}),e.jsxs(O,{value:a.benefit_type,onValueChange:s=>{h("benefit_type",s)},children:[e.jsx(W,{className:d.benefit_type?"border-red-500":"",children:e.jsx(Q,{placeholder:"Selecione o tipo de benefício"})}),e.jsx(H,{children:Object.entries(P).map(([s,t])=>e.jsx(J,{value:s,children:t},s))})]}),d.benefit_type&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:d.benefit_type}),a.benefit_type&&e.jsx("div",{className:"mt-2",children:e.jsx(n,{type:"button",variant:"outline",size:"sm",onClick:G,children:"Carregar tarefas padrão"})})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"name",children:"Nome do Template *"}),e.jsx(f,{id:"name",value:a.name,onChange:s=>h("name",s.target.value),placeholder:"Ex: Workflow - Aposentadoria por Idade",className:d.name?"border-red-500":""}),d.name&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:d.name})]})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"description",children:"Descrição"}),e.jsx(k,{id:"description",value:a.description,onChange:s=>h("description",s.target.value),placeholder:"Descrição do template de workflow...",rows:3})]})]})]}),e.jsxs(N,{children:[e.jsx(_,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(T,{children:"Tarefas do Workflow"}),e.jsx(y,{children:"Configure as tarefas que serão criadas automaticamente"})]}),e.jsxs(n,{type:"button",onClick:I,variant:"outline",children:[e.jsx(w,{className:"mr-2 h-4 w-4"}),"Adicionar Tarefa"]})]})}),e.jsxs(S,{className:"space-y-4",children:[d.tasks&&e.jsx("p",{className:"text-sm text-red-500",children:d.tasks}),o.map((s,t)=>e.jsxs("div",{className:"space-y-4 rounded-lg border p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(X,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("h4",{className:"font-medium",children:["Tarefa #",s.order]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(n,{type:"button",variant:"ghost",size:"sm",onClick:()=>g(t,"up"),disabled:t===0,children:"↑"}),e.jsx(n,{type:"button",variant:"ghost",size:"sm",onClick:()=>g(t,"down"),disabled:t===o.length-1,children:"↓"})]})]}),o.length>1&&e.jsx(n,{type:"button",variant:"destructive",size:"sm",onClick:()=>F(t),children:e.jsx(q,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:e.jsxs("div",{children:[e.jsx(m,{children:"Título da Tarefa"}),e.jsx(f,{value:s.title,onChange:r=>v(t,"title",r.target.value),placeholder:"Ex: Análise de Documentos Iniciais"})]})}),e.jsxs("div",{children:[e.jsx(m,{children:"Descrição"}),e.jsx(k,{value:s.description,onChange:r=>v(t,"description",r.target.value),placeholder:"Descrição detalhada da tarefa...",rows:2})]}),e.jsxs("div",{children:[e.jsx(m,{children:"Documentos Necessários"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(f,{placeholder:"Ex: RG, CPF, Comprovante de residência",onKeyPress:r=>{r.key==="Enter"&&(r.preventDefault(),b(t,r.currentTarget.value),r.currentTarget.value="")}}),e.jsx(n,{type:"button",variant:"outline",onClick:r=>{const i=r.currentTarget.previousElementSibling;b(t,i.value),i.value=""},children:e.jsx(w,{className:"h-4 w-4"})})]}),s.required_documents.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:s.required_documents.map((r,i)=>e.jsxs(B,{variant:"secondary",className:"flex items-center",children:[e.jsx("span",{children:r}),e.jsx(n,{type:"button",variant:"ghost",size:"sm",className:"ml-1 h-4 w-4 p-0 hover:bg-transparent",onClick:()=>A(t,i),children:e.jsx(q,{className:"h-3 w-3"})})]},i))})]})]})]},t))]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-4",children:[e.jsx(C,{href:"/tasks?tab=templates",children:e.jsx(n,{type:"button",variant:"outline",children:"Cancelar"})}),e.jsxs(n,{type:"submit",disabled:x,children:[e.jsx(Y,{className:"mr-2 h-4 w-4"}),x?"Salvando...":"Salvar Template"]})]})]})]})]})}export{be as default};
