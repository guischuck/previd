import{r,j as e,Q as oe,S as q}from"./app-WLgdctHE.js";import{B as P}from"./badge-AZ2JMr6f.js";import{a as U,B as f}from"./button-C_hdWeJT.js";import{C as l,b as g,c as N,a as c}from"./card-B9ABilfG.js";import{I as A}from"./input-xcfB5pT_.js";import{S as le,a as ce,b as de,c as me,d as he}from"./select-Ctv1h0M_.js";import{T as I}from"./textarea-BONqJJPl.js";import{S as z,A as xe,e as pe}from"./app-layout-DMq6fKxE.js";import{U as D}from"./user-Co5FF7Dd.js";import{F as L}from"./file-CAWekgmg.js";import{E as G}from"./eye-6zoCfW2M.js";import{A as ue}from"./arrow-left-CwlDV6Yj.js";import{S as je}from"./search-Dg-Z3FjQ.js";import{B as fe}from"./bot-BUvqjcH-.js";import{L as ge}from"./loader-circle-BlgnF-Qf.js";import{C as Ne}from"./circle-check-big-6MDnwIIt.js";/* empty css            */import"./index-BND9CRu0.js";import"./index-AgoEjcBu.js";import"./index-xBcEKAQ3.js";import"./chevron-up-Bep2Q40x.js";import"./app-logo-icon-OCgv-Ije.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],V=U("ChevronLeft",ve);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],R=U("Sparkles",be);function Re({cases:p,templates:v,categories:S,benefitTypes:w}){const[x,d]=r.useState("client"),[n,H]=r.useState("template"),[m,J]=r.useState(""),[h,Q]=r.useState(""),[b,_]=r.useState(""),[y,T]=r.useState(""),[M,o]=r.useState(""),[j,X]=r.useState(""),[O,K]=r.useState(""),[B]=r.useState({}),[F,C]=r.useState(!1),[u,W]=r.useState(""),Y=r.useMemo(()=>u?p.filter(s=>s.client_name.toLowerCase().includes(u.toLowerCase())||s.case_number.toLowerCase().includes(u.toLowerCase())||s.client_cpf&&s.client_cpf.includes(u)):p,[p,u]),i=r.useMemo(()=>p.find(s=>s.id.toString()===m),[p,m]),k=r.useMemo(()=>h?Object.values(v).flat().find(s=>s.id.toString()===h):null,[v,h]),Z=s=>{J(s);const a=p.find(t=>t.id.toString()===s);a!=null&&a.benefit_type&&_("requerimento"),d("method")},$=s=>{H(s),d(s==="template"?"template":"config")},ee=s=>{Q(s);const a=Object.values(v).flat().find(t=>t.id.toString()===s);a&&(_(a.category),T(`${a.name} - ${i==null?void 0:i.client_name}`)),d("config")},se=async()=>{var s;if(!(!h||!m)){C(!0);try{const a=await fetch("/api/generate-from-template",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""},body:JSON.stringify({template_id:h,case_id:m,variables:B})});if(a.ok){const t=await a.json();t.success?(o(t.content),d("preview")):o("Erro ao gerar petição: "+(t.error||"Erro desconhecido"))}else{const t=await a.json().catch(()=>({}));o("Erro ao gerar petição: "+(t.error||"Erro de conexão"))}}catch(a){console.error("Erro na geração:",a),o("Erro ao gerar petição. Tente novamente.")}finally{C(!1)}}},te=async()=>{var s;if(!(!m||!j)){C(!0);try{const a=await fetch("/api/generate-petition",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""},body:JSON.stringify({case_id:m,category:b,prompt:j,template_id:h||null})});if(a.ok){const t=await a.json();t.success?(o(t.content),d("preview")):o("Erro ao gerar petição: "+(t.error||"Erro desconhecido"))}else{const t=await a.json().catch(()=>({}));o("Erro ao gerar petição: "+(t.error||"Erro de conexão"))}}catch(a){console.error("Erro na geração:",a),o("Erro ao gerar petição. Tente novamente.")}finally{C(!1)}}},ae=()=>{q.post("/petitions",{case_id:m,type:n,template_id:h||null,category:b,title:y,content:M,template_variables:B,ai_prompt:j,notes:O})},E=[{id:"client",title:"Cliente",icon:D},{id:"method",title:"Método",icon:R},{id:"template",title:"Template",icon:L,show:n==="template"},{id:"config",title:"Configuração",icon:z},{id:"preview",title:"Preview",icon:G}].filter(s=>s.show!==!1),re=E.findIndex(s=>s.id===x);return e.jsxs(xe,{children:[e.jsx(oe,{title:"Nova Petição"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(f,{variant:"outline",size:"sm",onClick:()=>q.visit("/petitions"),children:[e.jsx(ue,{className:"mr-2 h-4 w-4"}),"Voltar"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Nova Petição"}),e.jsx("p",{className:"text-muted-foreground",children:"Crie petições usando templates ou inteligência artificial"})]})]})}),e.jsx("div",{className:"flex items-center justify-center gap-4 py-4",children:E.map((s,a)=>{const t=s.id===x,ie=a<re,ne=s.icon;return e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:`flex items-center gap-2 rounded-lg border px-4 py-2 transition-colors ${t?"border-primary bg-primary text-primary-foreground":ie?"border-green-200 bg-green-100 text-green-700":"border-border bg-muted text-muted-foreground"}`,children:[e.jsx(ne,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:s.title})]}),a<E.length-1&&e.jsx(pe,{className:"mx-2 h-4 w-4 text-muted-foreground"})]},s.id)})}),e.jsxs("div",{className:"flex-1",children:[x==="client"&&e.jsxs(l,{children:[e.jsx(g,{children:e.jsxs(N,{className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-5 w-5"}),"Selecionar Cliente"]})}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(je,{className:"absolute top-3 left-3 h-4 w-4 text-muted-foreground"}),e.jsx(A,{placeholder:"Buscar por nome, número do caso ou CPF...",value:u,onChange:s=>W(s.target.value),className:"pl-10"})]}),e.jsx("div",{className:"grid max-h-96 gap-3 overflow-y-auto",children:Y.map(s=>e.jsx(l,{className:`cursor-pointer transition-colors hover:bg-muted/50 ${m===s.id.toString()?"ring-2 ring-primary":""}`,onClick:()=>Z(s.id.toString()),children:e.jsx(c,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:s.client_name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Caso: ",s.case_number]}),s.client_cpf&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["CPF: ",s.client_cpf]})]}),s.benefit_type&&e.jsx(P,{variant:"secondary",children:w[s.benefit_type]||s.benefit_type})]})})},s.id))})]})]}),x==="method"&&e.jsxs(l,{children:[e.jsx(g,{children:e.jsxs(N,{className:"flex items-center gap-2",children:[e.jsx(R,{className:"h-5 w-5"}),"Escolher Método"]})}),e.jsx(c,{className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx(l,{className:`cursor-pointer transition-colors hover:bg-muted/50 ${n==="template"?"ring-2 ring-primary":""}`,onClick:()=>$("template"),children:e.jsxs(c,{className:"p-6 text-center",children:[e.jsx(L,{className:"mx-auto mb-4 h-12 w-12 text-blue-500"}),e.jsx("h3",{className:"mb-2 font-semibold",children:"Usar Template"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Escolha um template pré-definido e personalize com os dados do cliente"})]})}),e.jsx(l,{className:`cursor-pointer transition-colors hover:bg-muted/50 ${n==="ia"?"ring-2 ring-primary":""}`,onClick:()=>$("ia"),children:e.jsxs(c,{className:"p-6 text-center",children:[e.jsx(fe,{className:"mx-auto mb-4 h-12 w-12 text-purple-500"}),e.jsx("h3",{className:"mb-2 font-semibold",children:"Inteligência Artificial"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Gere uma petição personalizada usando IA com base nos dados do caso"})]})})]})})]}),x==="template"&&e.jsxs(l,{children:[e.jsx(g,{children:e.jsxs(N,{className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-5 w-5"}),"Selecionar Template"]})}),e.jsx(c,{className:"space-y-6",children:Object.entries(v).map(([s,a])=>e.jsxs("div",{children:[e.jsx("h3",{className:"mb-3 font-semibold",children:S[s]}),e.jsx("div",{className:"grid gap-3",children:a.map(t=>e.jsx(l,{className:`cursor-pointer transition-colors hover:bg-muted/50 ${h===t.id.toString()?"ring-2 ring-primary":""}`,onClick:()=>ee(t.id.toString()),children:e.jsx(c,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:t.name}),t.description&&e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:t.description})]}),e.jsxs("div",{className:"flex gap-2",children:[t.benefit_type&&e.jsx(P,{variant:"outline",children:w[t.benefit_type]}),e.jsx(P,{variant:"secondary",children:S[t.category]})]})]})})},t.id))})]},s))})]}),x==="config"&&e.jsxs(l,{children:[e.jsx(g,{children:e.jsxs(N,{className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-5 w-5"}),"Configuração"]})}),e.jsxs(c,{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Título da Petição"}),e.jsx(A,{value:y,onChange:s=>T(s.target.value),placeholder:"Digite o título da petição"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Categoria"}),e.jsxs(le,{value:b,onValueChange:_,children:[e.jsx(ce,{children:e.jsx(de,{placeholder:"Selecione a categoria"})}),e.jsx(me,{children:Object.entries(S).map(([s,a])=>e.jsx(he,{value:s,children:a},s))})]})]}),n==="ia"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Prompt para IA"}),e.jsx(I,{value:j,onChange:s=>X(s.target.value),placeholder:"Descreva o que você quer na petição...",rows:4})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Notas (opcional)"}),e.jsx(I,{value:O,onChange:s=>K(s.target.value),placeholder:"Notas adicionais...",rows:3})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"Dados do Cliente"}),i&&e.jsxs("div",{className:"space-y-2 rounded-lg bg-muted p-4",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Nome:"})," ",i.client_name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Caso:"})," ",i.case_number]}),i.client_cpf&&e.jsxs("p",{children:[e.jsx("strong",{children:"CPF:"})," ",i.client_cpf]}),i.benefit_type&&e.jsxs("p",{children:[e.jsx("strong",{children:"Benefício:"})," ",w[i.benefit_type]]})]}),k&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium",children:"Template Selecionado"}),e.jsxs("div",{className:"rounded-lg bg-muted p-4",children:[e.jsx("p",{children:e.jsx("strong",{children:k.name})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:k.description})]})]})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(f,{variant:"outline",onClick:()=>d(n==="template"?"template":"method"),children:[e.jsx(V,{className:"mr-2 h-4 w-4"}),"Voltar"]}),e.jsxs(f,{onClick:n==="template"?se:te,disabled:F||!y||!b||n==="ia"&&!j,children:[F&&e.jsx(ge,{className:"mr-2 h-4 w-4 animate-spin"}),n==="template"?"Gerar do Template":"Gerar com IA"]})]})]})]}),x==="preview"&&e.jsxs(l,{children:[e.jsx(g,{children:e.jsxs(N,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-5 w-5"}),"Preview da Petição"]})}),e.jsxs(c,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Título"}),e.jsx(A,{value:y,onChange:s=>T(s.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Conteúdo"}),e.jsx(I,{value:M,onChange:s=>o(s.target.value),rows:20,className:"font-mono"})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(f,{variant:"outline",onClick:()=>d("config"),children:[e.jsx(V,{className:"mr-2 h-4 w-4"}),"Editar"]}),e.jsxs(f,{onClick:ae,children:[e.jsx(Ne,{className:"mr-2 h-4 w-4"}),"Salvar Petição"]})]})]})]})]})]})]})}export{Re as default};
