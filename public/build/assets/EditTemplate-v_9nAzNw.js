import{r as x,j as e,Q as V,t as y,S as W}from"./app-D2IawdKC.js";import{B as G}from"./badge-BhH6_4yY.js";import{B as l}from"./button-DNBkhuBo.js";import{C as T,b as k,c as w,d as _,a as C}from"./card-iaGQ1KdM.js";import{I as u}from"./input-DjKTurB4.js";import{L as m}from"./label-DqtjYQjL.js";import{S as O,a as $,b as Q,c as R,d as H}from"./select-BKNin1bN.js";import{S as J}from"./switch-rMu1hxvJ.js";import{T as S}from"./textarea-fgDGdbTO.js";import{A as K,S as M}from"./app-layout-BYyG2lHs.js";import{A as U}from"./arrow-left-BOJvmNQQ.js";import{P as E}from"./plus-D9jE7atT.js";import{G as X}from"./grip-vertical-C78WXhVr.js";import{T as D}from"./trash-2-DemLsq-b.js";import{S as Y}from"./save-DBFd4T7E.js";/* empty css            */import"./index-DUQrCSJ5.js";import"./index-ClnT_KFv.js";import"./index-AmfJO-1_.js";import"./chevron-up-uakZWWTG.js";import"./app-logo-icon-DX44ml0d.js";function ge({template:c,benefitTypes:A}){const q=[{title:"Dashboard",href:"/dashboard"},{title:"Workflows",href:"/tasks"},{title:"Editar Template",href:`/tasks/templates/${c.id}/edit`}],[i,F]=x.useState({benefit_type:c.benefit_type,name:c.name,description:c.description||"",is_active:c.is_active}),[n,p]=x.useState(c.tasks||[]),[j,v]=x.useState(!1),[o,f]=x.useState({}),h=(t,a)=>{F(s=>({...s,[t]:a})),o[t]&&f(s=>({...s,[t]:""}))},P=t=>{t.preventDefault();const a={};i.benefit_type||(a.benefit_type="Selecione um tipo de benefício"),i.name.trim()||(a.name="Nome do template é obrigatório");const s=n.filter(r=>r.title.trim()&&r.description.trim());if(s.length===0&&(a.tasks="Adicione pelo menos uma tarefa válida"),Object.keys(a).length>0){f(a);return}v(!0),W.put(`/tasks/templates/${c.id}`,{benefit_type:i.benefit_type,name:i.name,description:i.description,is_active:i.is_active,tasks:JSON.stringify(s)},{onFinish:()=>v(!1),onError:r=>f(r)})},B=()=>{p([...n,{title:"",description:"",order:n.length+1,required_documents:[]}])},I=t=>{const s=n.filter((r,d)=>d!==t).map((r,d)=>({...r,order:d+1}));p(s)},b=(t,a,s)=>{const r=[...n];r[t]={...r[t],[a]:s},p(r)},g=(t,a)=>{if(a.trim()){const s=[...n];s[t].required_documents=[...s[t].required_documents,a.trim()],p(s)}},z=(t,a)=>{const s=[...n];s[t].required_documents=s[t].required_documents.filter((r,d)=>d!==a),p(s)},N=(t,a)=>{const s=[...n],r=a==="up"?t-1:t+1;r>=0&&r<s.length&&([s[t],s[r]]=[s[r],s[t]],s.forEach((d,L)=>{d.order=L+1}),p(s))};return e.jsxs(K,{breadcrumbs:q,children:[e.jsx(V,{title:`Editar Template: ${c.name} - PrevidIA`}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"flex items-center text-3xl font-bold",children:[e.jsx(M,{className:"mr-3 h-8 w-8 text-primary"}),"Editar Template de Workflow"]}),e.jsxs("p",{className:"text-muted-foreground",children:['Edite o template "',c.name,'"']})]}),e.jsx(y,{href:"/tasks?tab=templates",children:e.jsxs(l,{variant:"outline",children:[e.jsx(U,{className:"mr-2 h-4 w-4"}),"Voltar"]})})]}),e.jsxs("form",{onSubmit:P,className:"space-y-6",children:[e.jsxs(T,{children:[e.jsxs(k,{children:[e.jsx(w,{children:"Informações do Template"}),e.jsx(_,{children:"Configure as informações básicas do template"})]}),e.jsxs(C,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"benefit_type",children:"Tipo de Benefício *"}),e.jsxs(O,{value:i.benefit_type,onValueChange:t=>h("benefit_type",t),children:[e.jsx($,{className:o.benefit_type?"border-red-500":"",children:e.jsx(Q,{placeholder:"Selecione o tipo de benefício"})}),e.jsx(R,{children:Object.entries(A).map(([t,a])=>e.jsx(H,{value:t,children:a},t))})]}),o.benefit_type&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:o.benefit_type})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"name",children:"Nome do Template *"}),e.jsx(u,{id:"name",value:i.name,onChange:t=>h("name",t.target.value),placeholder:"Ex: Workflow - Aposentadoria por Idade",className:o.name?"border-red-500":""}),o.name&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:o.name})]})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"description",children:"Descrição"}),e.jsx(S,{id:"description",value:i.description,onChange:t=>h("description",t.target.value),placeholder:"Descrição do template de workflow...",rows:3})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(J,{id:"is_active",checked:i.is_active,onCheckedChange:t=>h("is_active",t)}),e.jsx(m,{htmlFor:"is_active",children:"Template ativo"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:i.is_active?"Este template será usado para criar tarefas automaticamente":"Este template está desabilitado"})]})]})]}),e.jsxs(T,{children:[e.jsx(k,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(w,{children:"Tarefas do Workflow"}),e.jsx(_,{children:"Configure as tarefas que serão criadas automaticamente"})]}),e.jsxs(l,{type:"button",onClick:B,variant:"outline",children:[e.jsx(E,{className:"mr-2 h-4 w-4"}),"Adicionar Tarefa"]})]})}),e.jsxs(C,{className:"space-y-4",children:[o.tasks&&e.jsx("p",{className:"text-sm text-red-500",children:o.tasks}),n.map((t,a)=>e.jsxs("div",{className:"space-y-4 rounded-lg border p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(X,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("h4",{className:"font-medium",children:["Tarefa #",t.order]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(l,{type:"button",variant:"ghost",size:"sm",onClick:()=>N(a,"up"),disabled:a===0,children:"↑"}),e.jsx(l,{type:"button",variant:"ghost",size:"sm",onClick:()=>N(a,"down"),disabled:a===n.length-1,children:"↓"})]})]}),n.length>1&&e.jsx(l,{type:"button",variant:"destructive",size:"sm",onClick:()=>I(a),children:e.jsx(D,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:e.jsxs("div",{children:[e.jsx(m,{children:"Título da Tarefa"}),e.jsx(u,{value:t.title,onChange:s=>b(a,"title",s.target.value),placeholder:"Ex: Análise de Documentos Iniciais"})]})}),e.jsxs("div",{children:[e.jsx(m,{children:"Descrição"}),e.jsx(S,{value:t.description,onChange:s=>b(a,"description",s.target.value),placeholder:"Descrição detalhada da tarefa...",rows:2})]}),e.jsxs("div",{children:[e.jsx(m,{children:"Documentos Necessários"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(u,{placeholder:"Ex: RG, CPF, Comprovante de residência",onKeyPress:s=>{s.key==="Enter"&&(s.preventDefault(),g(a,s.currentTarget.value),s.currentTarget.value="")}}),e.jsx(l,{type:"button",variant:"outline",onClick:s=>{const r=s.currentTarget.previousElementSibling;g(a,r.value),r.value=""},children:e.jsx(E,{className:"h-4 w-4"})})]}),t.required_documents.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:t.required_documents.map((s,r)=>e.jsxs(G,{variant:"secondary",className:"flex items-center",children:[e.jsx("span",{children:s}),e.jsx(l,{type:"button",variant:"ghost",size:"sm",className:"ml-1 h-4 w-4 p-0 hover:bg-transparent",onClick:()=>z(a,r),children:e.jsx(D,{className:"h-3 w-3"})})]},r))})]})]})]},a))]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-4",children:[e.jsx(y,{href:"/tasks?tab=templates",children:e.jsx(l,{type:"button",variant:"outline",children:"Cancelar"})}),e.jsxs(l,{type:"submit",disabled:j,children:[e.jsx(Y,{className:"mr-2 h-4 w-4"}),j?"Salvando...":"Salvar Alterações"]})]})]})]})]})}export{ge as default};
