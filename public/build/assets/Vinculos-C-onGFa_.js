import{r as u,j as e,Q as V,t as K}from"./app-BLxXbY_b.js";import{B as E}from"./button-DT3cAopr.js";import{C as S,b as A,c as k,a as R,d as q}from"./card-DXsYbZZ8.js";import{D as Q,a as G,b as W,c as Y,d as Z,e as ee}from"./dialog-CY9aLdN-.js";import{T as se,a as ae,b as X,c as b,d as oe,e as N}from"./table-weDIbobR.js";import{A as te,F as re,a as F}from"./app-layout-G5Onjp1f.js";import{A as ne}from"./arrow-left-DkkcmHkS.js";import{C as le,a as ce}from"./chevron-up-B9Jrt4ee.js";import{C as de}from"./copy-D6rYDouB.js";/* empty css            */import"./index-6jQRo-49.js";import"./index-Ci0KITsv.js";import"./app-logo-icon-DgzmCoEH.js";const j=t=>{if(!t)return"Em andamento";const m=t.split("T")[0].split("-");return m.length!==3?t:`${m[2]}/${m[1]}/${m[0]}`};function ie(t){const p=t.split("/");return p.length!==3?null:`${p[2]}-${p[1]}-${p[0]}`}function B({value:t,onChange:p}){const[m,c]=u.useState(!1),[x,h]=u.useState(t?j(t):""),[f,v]=u.useState(!1);u.useEffect(()=>{h(t?j(t):"")},[t]);const g=async()=>{if(x!==(t?j(t):"")){v(!0);const n=ie(x);n&&await p(n),v(!1)}c(!1)};return m?e.jsx("input",{type:"text",value:x,placeholder:"DD/MM/AAAA",onChange:n=>h(n.target.value),onBlur:g,onKeyDown:n=>n.key==="Enter"&&g(),className:`rounded border px-2 py-1 ${f?"opacity-50":""}`,disabled:f,autoFocus:!0}):e.jsx("span",{onClick:()=>c(!0),className:"cursor-pointer text-blue-600 underline hover:text-blue-800 dark:text-blue-300",children:t?j(t):"---"})}function O({value:t,onChange:p,placeholder:m}){const[c,x]=u.useState(!1),[h,f]=u.useState(t),[v,g]=u.useState(!1);u.useEffect(()=>{f(t)},[t]);const n=async()=>{h!==t&&(g(!0),await p(h),g(!1)),x(!1)};return c?e.jsx("input",{type:"text",value:h,placeholder:m,onChange:w=>f(w.target.value),onBlur:n,onKeyDown:w=>w.key==="Enter"&&n(),className:`w-full rounded border px-2 py-1 ${v?"opacity-50":""}`,disabled:v,autoFocus:!0}):e.jsx("span",{onClick:()=>x(!0),className:"cursor-pointer text-blue-600 underline hover:text-blue-800 dark:text-blue-300",children:t||e.jsx("span",{className:"text-muted-foreground",children:m})})}function Te({case:t}){const p=[{title:"Dashboard",href:"/dashboard"},{title:"Casos",href:"/cases"},{title:t.case_number,href:`/cases/${t.id}`},{title:"Vínculos Empregatícios",href:`/cases/${t.id}/vinculos`}],m=s=>{if(!s)return"Não informado";const o=s.replace(/\D/g,"");return o.length===14?o.replace(/^(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})$/,"$1.$2.$3/$4-$5"):s},[c,x]=u.useState(t.employment_relationships),[h,f]=u.useState(null),[v,g]=u.useState(!1),[n,w]=u.useState(null),[L,D]=u.useState({});u.useEffect(()=>{(async()=>{try{for(const o of c){const a=await fetch(`/api/employment-relationships/${o.id}/tentativas`);a.ok&&(await a.json()).forEach(i=>{["endereco","rastreamento","data_envio","retorno","email","telefone"].forEach(d=>{if(i[d]){const $=`${o.id}_${i.tentativa_num}_${d}`;D(_=>({..._,[$]:i[d]}))}})})}}catch(o){console.error("Erro ao carregar tentativas:",o)}})()},[c]);const z=s=>{f(h===s?null:s)},J=async s=>{var r;const o=[...c],a=!o[s].is_active;o[s]={...o[s],is_active:a},x(o);try{console.log("Enviando toggle status:",{id:o[s].id,is_active:a});const i=await fetch(`/api/employment-relationships/${o[s].id}`,{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.getAttribute("content"))||""},body:JSON.stringify({is_active:a})});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const l=await i.json();console.log("Status alterado com sucesso:",l),l.case_progress&&l.case_id&&(window.dispatchEvent(new CustomEvent("caseProgressUpdated",{detail:{caseId:l.case_id,progress:l.case_progress,status:l.case_status}})),localStorage.setItem(`case_progress_${l.case_id}`,JSON.stringify({progress:l.case_progress,status:l.case_status,timestamp:Date.now()})),console.log("Progresso do caso atualizado:",l.case_progress))}catch(i){console.error("Erro ao salvar status:",i),alert("Erro ao salvar status. Tente novamente.");const l=[...c];l[s].is_active=!a,x(l)}},H=s=>{const o=[...c];o.splice(s,1),x(o)},U=s=>{w(s),g(!0)},M=()=>g(!1),P=async(s,o,a)=>{var i;const r=[...c];r[s]={...r[s],[o]:a},x(r);try{const l=await fetch(`/api/employment-relationships/${r[s].id}`,{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((i=document.querySelector('meta[name="csrf-token"]'))==null?void 0:i.getAttribute("content"))||""},body:JSON.stringify({[o]:a})});if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);const d=await l.json();console.log("Campo salvo com sucesso:",d)}catch(l){console.error("Erro ao salvar campo:",l),alert(`Erro ao salvar ${o}. Tente novamente.`)}},y=async(s,o,a,r)=>{var l;const i=`${c[s].id}_${o}_${a}`;D(d=>({...d,[i]:r}));try{console.log("Salvando tentativa:",{employmentId:c[s].id,tentativa:o,field:a,value:r,url:`/api/employment-relationships/${c[s].id}/tentativas/${o}`});const d=await fetch(`/api/employment-relationships/${c[s].id}/tentativas/${o}`,{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((l=document.querySelector('meta[name="csrf-token"]'))==null?void 0:l.getAttribute("content"))||""},body:JSON.stringify({[a]:r})});if(!d.ok){const _=await d.text();throw console.error("Erro HTTP:",d.status,_),new Error(`HTTP error! status: ${d.status} - ${_}`)}const $=await d.json();console.log("Tentativa salva com sucesso:",$)}catch(d){console.error("Erro ao salvar tentativa:",d);const $=d instanceof Error?d.message:"Erro desconhecido";alert(`Erro ao salvar ${a} da tentativa ${o}. Tente novamente. Erro: ${$}`)}},C=(s,o,a)=>{const r=`${s}_${o}_${a}`;return L[r]||""},T=(s,o,a,r)=>{const i=`${s}_${o}_${a}`;D(l=>({...l,[i]:r}))},I=s=>`NOTIFICAÇÃO EXTRAJUDICIAL REQUERIMENTO DE PPP E LTCAT

${s.employer_name}
CNPJ: ${m(s.employer_cnpj)}

${t.client_name}, neste ato representado por seu advogado que este subscreve, vem, por meio deste, solicitar a emissão de PPP (Perfil Profissiográfico Previdenciário) com o respectivo LTCAT (Laudo Técnico das Condições Ambientais de Trabalho), para fins de instrução no processo de aposentadoria em face do Instituto Nacional do Seguro Social - INSS.

Vale salientar que o PPP somente é válido diante do preenchimento de todos os campos, principalmente aos que se referem à exposição dos agentes nocivos, indicação do responsável técnico pelos registros ambientais (Tema 208 - TNU), carimbo e assinatura do responsável da empresa. Ressalta-se, ainda, que o documento deve seguir o modelo estabelecido pela Instrução normativa nº 133/2022 e 128/2022.

Requer também que o PPP venha acompanhado de autorização que identifique o representante legal responsável pela assinatura do laudo ou a cópia do contrato social da empresa, quando o representante legal for o sócio da mesma.

Os documentos deverão ser encaminhados por e-mail para extrajudicial@koetzadvocacia.com.br

DADOS DO REQUERENTE:
Nome: ${t.client_name}
CPF: ${t.client_cpf}
Período: ${j(s.start_date)} a ${j(s.end_date)}

Certa de vossa atenção,
aguardo retorno. Atenciosamente,
Eduardo Koetz - OAB/SC 42.934`;return e.jsxs(te,{breadcrumbs:p,children:[e.jsx(V,{title:`Vínculos - ${t.case_number} - Sistema Jurídico`}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(K,{href:`/cases/${t.id}`,children:e.jsxs(E,{variant:"outline",size:"sm",children:[e.jsx(ne,{className:"mr-2 h-4 w-4"}),"Voltar ao Caso"]})})}),e.jsx("h1",{className:"mt-4 text-3xl font-bold",children:"Vínculos Empregatícios"}),e.jsxs("p",{className:"text-muted-foreground",children:["Caso: ",t.case_number," - ",t.client_name]})]})}),e.jsxs(S,{children:[e.jsx(A,{children:e.jsxs(k,{className:"flex items-center space-x-2",children:[e.jsx(re,{className:"h-5 w-5"}),e.jsx("span",{children:"Informações do Cliente"})]})}),e.jsx(R,{children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Nome do Cliente"}),e.jsx("p",{className:"text-lg",children:t.client_name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"CPF"}),e.jsx("p",{className:"text-lg",children:t.client_cpf})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Número do Caso"}),e.jsx("p",{className:"font-mono text-lg",children:t.case_number})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total de Vínculos"}),e.jsx("p",{className:"text-lg font-bold text-blue-600",children:t.employment_relationships.length})]})]})})]}),e.jsxs(S,{children:[e.jsxs(A,{children:[e.jsx(k,{children:"Lista de Vínculos Empregatícios"}),e.jsx(q,{children:"Edite os dados e eles serão salvos automaticamente"})]}),e.jsx(R,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(se,{children:[e.jsx(ae,{children:e.jsxs(X,{children:[e.jsx(b,{children:"Empregador"}),e.jsx(b,{children:"CNPJ"}),e.jsx(b,{children:"Data Início"}),e.jsx(b,{children:"Data Fim"}),e.jsx(b,{children:"Cargo"}),e.jsx(b,{children:"Documentos"}),e.jsx(b,{children:"Observações"})]})}),e.jsx(oe,{children:c.map((s,o)=>e.jsxs(X,{children:[e.jsx(N,{children:s.employer_name}),e.jsx(N,{children:e.jsx("code",{className:"rounded bg-muted px-2 py-1 text-sm text-foreground",children:m(s.employer_cnpj)})}),e.jsx(N,{children:e.jsx(B,{value:s.start_date,onChange:a=>P(o,"start_date",a)})}),e.jsx(N,{children:e.jsx(B,{value:s.end_date,onChange:a=>P(o,"end_date",a)})}),e.jsx(N,{children:e.jsx(O,{value:s.cargo||"",onChange:a=>P(o,"cargo",a),placeholder:"Cargo"})}),e.jsx(N,{children:e.jsx(O,{value:s.documentos||"",onChange:a=>P(o,"documentos",a),placeholder:"Documentos"})}),e.jsx(N,{children:e.jsx(O,{value:s.observacoes||"",onChange:a=>P(o,"observacoes",a),placeholder:"Observações"})})]},s.id))})]})})})]}),e.jsxs(S,{children:[e.jsxs(A,{children:[e.jsxs(k,{className:"flex items-center space-x-2",children:[e.jsx(F,{className:"h-5 w-5"}),e.jsx("span",{children:"Vínculos Empregatícios"})]}),e.jsx(q,{children:"Lista de todos os vínculos empregatícios extraídos do CNIS"})]}),e.jsx(R,{children:t.employment_relationships.length>0?e.jsx("div",{className:"overflow-x-auto",children:c.map((s,o)=>e.jsxs("div",{className:"mb-4 rounded-lg border bg-card shadow-sm",children:[e.jsxs("div",{className:"flex cursor-pointer items-center justify-between px-4 py-3",onClick:()=>z(o),children:[e.jsx("span",{className:"text-lg font-bold",children:s.employer_name}),e.jsxs("div",{className:"ml-auto flex gap-2",children:[e.jsx(E,{size:"sm",variant:s.is_active?"secondary":"default",className:s.is_active?"bg-yellow-100 text-yellow-800 hover:bg-yellow-200":"bg-green-100 text-green-800 hover:bg-green-200",onClick:a=>{a.stopPropagation(),J(o)},children:s.is_active?"Pendente":"Concluído"}),e.jsx(E,{size:"sm",variant:"outline",className:"border-blue-300 text-blue-700 hover:bg-blue-50",onClick:a=>{a.stopPropagation(),U(s)},children:"Gerar Carta"}),e.jsx(E,{size:"sm",variant:"destructive",onClick:a=>{a.stopPropagation(),H(o)},children:"Remover"}),e.jsx("span",{children:h===o?e.jsx(le,{}):e.jsx(ce,{})})]})]}),h===o&&e.jsxs("div",{className:"border-t bg-muted p-4",children:[e.jsx("div",{className:"mb-2 font-semibold",children:"Tentativas de Contato"}),e.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[1,2,3].map(a=>e.jsxs("div",{className:"rounded-lg border bg-background p-4",children:[e.jsxs("div",{className:"mb-2 font-medium",children:["Tentativa ",a]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Endereço"}),e.jsx("input",{type:"text",className:"w-full rounded border px-2 py-1",placeholder:"Rua, número, cidade...",value:C(s.id,a,"endereco"),onChange:r=>T(s.id,a,"endereco",r.target.value),onBlur:r=>y(o,a,"endereco",r.target.value)})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Cód. Rastreio"}),e.jsx("input",{type:"text",className:"w-full rounded border px-2 py-1",placeholder:"XX123456789BR",value:C(s.id,a,"rastreamento"),onChange:r=>T(s.id,a,"rastreamento",r.target.value),onBlur:r=>y(o,a,"rastreamento",r.target.value)})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Data de Envio"}),e.jsx("input",{type:"date",className:"w-full rounded border px-2 py-1",value:C(s.id,a,"data_envio"),onChange:r=>T(s.id,a,"data_envio",r.target.value),onBlur:r=>y(o,a,"data_envio",r.target.value)})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Retorno"}),e.jsxs("select",{className:"w-full rounded border px-2 py-1",value:C(s.id,a,"retorno")||"Aguardando",onChange:r=>{T(s.id,a,"retorno",r.target.value),y(o,a,"retorno",r.target.value)},children:[e.jsx("option",{value:"Aguardando",children:"Aguardando"}),e.jsx("option",{value:"Recebido",children:"Recebido"}),e.jsx("option",{value:"Devolvido",children:"Devolvido"}),e.jsx("option",{value:"Não Localizado",children:"Não Localizado"})]})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Email"}),e.jsx("input",{type:"email",className:"w-full rounded border px-2 py-1",placeholder:"contato@empresa.com",value:C(s.id,a,"email"),onChange:r=>T(s.id,a,"email",r.target.value),onBlur:r=>y(o,a,"email",r.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Telefone"}),e.jsx("input",{type:"text",className:"w-full rounded border px-2 py-1",placeholder:"(XX) XXXXX-XXXX",value:C(s.id,a,"telefone"),onChange:r=>T(s.id,a,"telefone",r.target.value),onBlur:r=>y(o,a,"telefone",r.target.value)})]})]},a))})]})]},s.id))}):e.jsxs("div",{className:"py-12 text-center",children:[e.jsx(F,{className:"mx-auto mb-4 h-12 w-12 text-muted-foreground"}),e.jsx("h3",{className:"mb-2 text-lg font-medium",children:"Nenhum vínculo encontrado"}),e.jsx("p",{className:"text-muted-foreground",children:"Este caso ainda não possui vínculos empregatícios cadastrados."})]})})]}),e.jsx(Q,{open:v,onOpenChange:g,children:e.jsxs(G,{className:"max-h-[90vh] w-full max-w-2xl overflow-y-auto md:max-w-4xl",children:[e.jsxs(W,{children:[e.jsx(Y,{className:"text-lg md:text-xl",children:"Notificação Extrajudicial - Requerimento de PPP e LTCAT"}),e.jsxs(Z,{className:"text-sm md:text-base",children:["Carta para: ",e.jsx("b",{children:n==null?void 0:n.employer_name})," - CNPJ: ",e.jsx("b",{children:m((n==null?void 0:n.employer_cnpj)||"")})]})]}),e.jsxs("div",{className:"my-4 rounded-lg border bg-card text-foreground p-4 font-mono text-xs leading-relaxed md:p-6 md:text-sm",children:[e.jsx("div",{className:"mb-4 text-center md:mb-6",children:e.jsx("h2",{className:"mb-2 text-base font-bold md:text-lg",children:"NOTIFICAÇÃO EXTRAJUDICIAL REQUERIMENTO DE PPP E LTCAT"})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"font-bold",children:n==null?void 0:n.employer_name}),e.jsxs("p",{children:["CNPJ: ",m((n==null?void 0:n.employer_cnpj)||"")]})]}),e.jsxs("div",{className:"mb-6 space-y-4 text-justify",children:[e.jsxs("p",{children:[e.jsx("strong",{children:t.client_name}),", neste ato representado por seu advogado que este subscreve, vem, por meio deste, solicitar a emissão de PPP (Perfil Profissiográfico Previdenciário) com o respectivo LTCAT (Laudo Técnico das Condições Ambientais de Trabalho), para fins de instrução no processo de aposentadoria em face do Instituto Nacional do Seguro Social - INSS."]}),e.jsx("p",{children:"Vale salientar que o PPP somente é válido diante do preenchimento de todos os campos, principalmente aos que se referem à exposição dos agentes nocivos, indicação do responsável técnico pelos registros ambientais (Tema 208 - TNU), carimbo e assinatura do responsável da empresa. Ressalta-se, ainda, que o documento deve seguir o modelo estabelecido pela Instrução normativa nº 133/2022 e 128/2022."}),e.jsx("p",{children:"Requer também que o PPP venha acompanhado de autorização que identifique o representante legal responsável pela assinatura do laudo ou a cópia do contrato social da empresa, quando o representante legal for o sócio da mesma."}),e.jsxs("p",{children:["Os documentos deverão ser encaminhados por e-mail para ",e.jsx("strong",{children:"extrajudicial@koetzadvocacia.com.br"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"mb-2 font-bold",children:"DADOS DO REQUERENTE:"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Nome:"})," ",t.client_name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"CPF:"})," ",t.client_cpf]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Período:"})," ",n?`${j(n.start_date)} a ${j(n.end_date)}`:""]})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("p",{className:"mb-2",children:"Certa de vossa atenção,"}),e.jsx("p",{className:"mb-4",children:"aguardo retorno. Atenciosamente,"}),e.jsx("p",{className:"font-bold",children:"Eduardo Koetz - OAB/SC 42.934"})]})]}),e.jsxs(ee,{className:"flex flex-col gap-2 sm:flex-row",children:[e.jsxs(E,{variant:"outline",className:"w-full sm:w-auto",onClick:async()=>{if(n)try{const s=I(n);await navigator.clipboard.writeText(s),alert("Carta copiada para a área de transferência!")}catch{const o=document.createElement("textarea");o.value=I(n),document.body.appendChild(o),o.select(),document.execCommand("copy"),document.body.removeChild(o),alert("Carta copiada para a área de transferência!")}},children:[e.jsx(de,{className:"mr-2 h-4 w-4"}),"Copiar Texto"]}),e.jsx(E,{onClick:M,className:"w-full sm:w-auto",children:"Fechar"})]})]})})]})]})}export{Te as default};
